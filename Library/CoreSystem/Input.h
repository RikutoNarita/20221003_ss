//==============================================================================
// Filename: Input.h
// Description: キーボード・マウスの入力クラス
// Copyright (C) Silicon Studio Co., Ltd. All rights reserved.
//==============================================================================

// インクルードガード
#ifndef __INPUT_MANAGER_H__
#define __INPUT_MANAGER_H__

// インクルード
#include <Win_Main.h>
#define DIRECTINPUT_VERSION    0x0800   // DirectInputのバージョン指定
#include <dinput.h>


// マクロ定義
#define KEY_MAX    (256)
#define INPUT (CInput::GetInstance()) // インスタンスの取得

// 列挙体
enum class MOUSE_BUTTON
{
    MOUSE_L,    // 左クリック
    MOUSE_R,    // 右クリック
    MOUSE_M     // ホイール
};

// クラス定義
class CInput
{
    
public:
    //------------------------------------------------------------------------------

    //------------------------------------------------------------------------------
    /// デストラクタ
    ///
    /// \return void
    //------------------------------------------------------------------------------
    ~CInput();

    //------------------------------------------------------------------------------
    /// インスタンスの取得
    /// 
    /// \return クラスのインスタンス
    //------------------------------------------------------------------------------
    static CInput* GetInstance();

    //------------------------------------------------------------------------------
    /// 入力の初期化
    /// 
    /// \return 初期化の成否
    //------------------------------------------------------------------------------
    HRESULT Init();

    //------------------------------------------------------------------------------
    /// 入力の終了処理
    /// 
    /// \return void
    //------------------------------------------------------------------------------
    void Uninit();

    //------------------------------------------------------------------------------
    /// 入力の更新処理
    /// 
    /// \return void
    //------------------------------------------------------------------------------
    void Update();

    //------------------------------------------------------------------------------
    /// キーボードのプレス状態を取得
    /// 
    /// \param[in] key 入力状態を確認したいキー
    /// 
    /// \return キーボードのプレス状態
    //------------------------------------------------------------------------------
    bool GetKeyPress(
    /*[in]*/
    unsigned char key);

    //------------------------------------------------------------------------------
    /// キーボードのトリガ状態を取得
    /// 
    /// \param[in] key 入力状態を確認したいキー
    /// 
    /// \return キーボードのトリガ状態
    //------------------------------------------------------------------------------
    bool GetKeyTrigger(
    /*[in]*/
    unsigned char key); 

    //------------------------------------------------------------------------------
    /// キーボードのリリース状態を取得
    /// 
    /// \param[in] key 入力状態を確認したいキー
    /// 
    /// \return キーボードのリリース状態
    //------------------------------------------------------------------------------
    bool GetKeyRelease(
    /*[in]*/
    unsigned char key);

    //------------------------------------------------------------------------------
    /// マウスのプレス状態を取得
    /// 
    /// \param[in] Btn 入力状態を確認したいボタン
    /// 
    /// \return マウスのプレス状態
    //------------------------------------------------------------------------------
    bool GetMouseButton(
    /*[in]*/
    MOUSE_BUTTON Btn);

    //------------------------------------------------------------------------------
    /// マウスのトリガ状態を取得
    /// 
    /// \param[in] Btn 入力状態を確認したいボタン
    /// 
    /// \return マウスのトリガ状態
    //------------------------------------------------------------------------------
    bool GetMouseTrigger(
    /*[in]*/
    MOUSE_BUTTON Btn);

    //------------------------------------------------------------------------------
    /// マウスのリリース状態を取得
    /// 
    /// \param[in] Btn 入力状態を確認したいボタン
    /// 
    /// \return マウスのリリース状態
    //------------------------------------------------------------------------------
    bool GetMouseRelease(
    /*[in]*/
    MOUSE_BUTTON Btn);

    //------------------------------------------------------------------------------
    /// マウス座標の取得
    /// 
    /// \return マウス座標
    //------------------------------------------------------------------------------
    DirectX::XMFLOAT2 GetMousePos() const;

    //------------------------------------------------------------------------------
    /// マウスの移動量の取得
    /// 
    /// \return マウスの移動量
    //------------------------------------------------------------------------------
    DirectX::XMFLOAT2 GetMouseVelocity() const;

    //------------------------------------------------------------------------------


private:

    //------------------------------------------------------------------------------

    //------------------------------------------------------------------------------
    /// コンストラクタ
    ///
    /// \return void
    //------------------------------------------------------------------------------
    CInput();

    //------------------------------------------------------------------------------
    /// キーボード初期化
    ///
    /// \return 初期化の成否
    //------------------------------------------------------------------------------
    HRESULT InitKeyBoard();

    //------------------------------------------------------------------------------
    /// キーボード更新
    ///
    /// \return void
    //------------------------------------------------------------------------------
    void UpdateKeyBoard();

    //------------------------------------------------------------------------------
    /// マウス初期化
    ///
    /// \return 初期化の成否
    //------------------------------------------------------------------------------
    HRESULT InitMouse();

    //------------------------------------------------------------------------------
    /// マウス更新
    ///
    /// \return void
    //------------------------------------------------------------------------------
    void UpdateMouse();

    //------------------------------------------------------------------------------
    
    //------------------------------------------------------------------------------
    static CInput* m_pInstance;                 // インスタンス用
    unsigned char m_currentKeyState[KEY_MAX];   // 現在のキーボード入力情報の格納先
    unsigned char m_prevKeyState[KEY_MAX];      // 前フレームのキーボード入力情報の格納先
    DIMOUSESTATE m_currentMouseState;           // マウスの現在の入力情報
    DIMOUSESTATE m_prevMouseState;              // マウスの一フレーム前の入力情報
    DirectX::XMFLOAT2   m_mousePos;             // マウス座標
    //------------------------------------------------------------------------------
    /// <summary>
    /// m_pInstance
    /// m_currentKeyState[KEY_MAX]
    /// m_prevKeyState[KEY_MAX]
    /// m_currentMouseState
    /// m_prevMouseState
    /// m_mousePos
    /// </summary> 
};

#endif // __INPUT_MANAGER_H__
